@model TimelyDepotMVC.Models.Admin.SalesOrder

@{
    ViewBag.Title = "Customer Sales Order";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Scripts {
    @*@Scripts.Render("~/bundles/jqueryval")*@
    <script type="text/javascript">
        jQuery(document).ready(initializeSalesOrderIndex);

        function initializeSalesOrderIndex() {

            //Set the buttons
            jQuery(".btnSubmitSearch").button();
            jQuery(".btnEditSO").button();

            //Intialize fields 
            //debugger;
            jQuery("#ShippingHandling").css("text-align", "right");
            //jQuery("#SalesOrderNo").attr("readonly", "readonly");

            //Attach handlers 
            jQuery("#lnkselectvendorid").click(clicklnkselectvendorid);
            jQuery("#lnkselectlocationid").click(clicklnkselectlocationid);
            jQuery("#getsalesdetailsId").click(clickgetsalesdetailsId);
            jQuery("#lnkBlindShip").click(clicklnkBlindShip);
            jQuery("#lnkEditBlindShip").click(clicklnkBlindShip);
            jQuery("#IsBlindShip").click(clickIsBlindShip);
            jQuery("#salesordercontactselectorId").change(changesalesordercontactselectorId);
            jQuery("#editsalesorderid").submit(submiteditsalesorderid);

            //Prepare the dialogs 
            jQuery("#loadingHlpDialogid").dialog({ autoOpen: false, modal: true });
            jQuery("#selectvendorDialog").dialog({ autoOpen: false, modal: true });

            //debugger;

            //Display sales details
            jQuery("#getsalesdetailsId").trigger('click');

            //Set the datepicker
            jQuery("#ShipDateHlp").datepicker({
                dateFormat: "mm/dd/yy",
                showOn: "button",
                buttonImage: "/images/calendar.gif",
                buttonImageOnly: true
            });

            jQuery("#SODateHlp").datepicker({
                dateFormat: "mm/dd/yy",
                showOn: "button",
                buttonImage: "/images/calendar.gif",
                buttonImageOnly: true
            });
        }

        function clicklnkselectvendorid(src, arg) {
            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get the partial view
            var szUrl = jQuery(src.target).attr("href");

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: selectvendorSuccess
            });
        }

        function AjaxFailed(response, statusCode, optionerror) {
            //debugger;
            //var response = ajaxContext.get_response();
            //var statusCode = response.get_statusCode();
            alert("Sorry, the request failed with status code: " + statusCode);
        }

        function selectvendorSuccess(response, statusCode) {
            //debugger;
            var objRes = response;

            //Display the response data
            jQuery("#selectvendorDialog").html(objRes);

            //Hide load image
            HideLoadingDialog();

            //Set the buttons lnkResetId
            jQuery(".btn btn-default").button();

            //Attach handlers lnkSelectVendor
            jQuery("#btDialogClose").click(clickbtDialogClose);
            jQuery("#btnSubmitSearchVendorid").click(clickbtnSubmitSearchVendorid);
            jQuery(".btnSubmitSearchVendor a").each(eachbtnSubmitSearchVendor);
            jQuery(".lnkSelectVendor a").each(eachlnkSelectVendor);



            jQuery(".pagination ul li a").each(eachlnknavigation);
            //Initialize fields

            //Get the title 
            //debugger;
            var szTitle = "Vendor";

            //Show the dialog (used with the BuscarDepartamento call)
            jQuery("#selectvendorDialog").dialog("option", "title", "Select " + szTitle);

            //setter
            jQuery("#selectvendorDialog").dialog("option", "width", 900);

            //display the popup dialog
            jQuery("#selectvendorDialog").dialog("open");

        }

        function clickbtDialogClose(src, arg) {
            jQuery("#selectvendorDialog").dialog("close");
        }

        function eachbtnSubmitSearchVendor(nPos, src) {
            //debugger;
            jQuery(src).click(clicklnkselectvendorreset);
        }

        function clicklnkselectvendorreset(src, arg) {
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get the partial view
            var szUrl = jQuery(src.target.parentNode).attr("href");

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: selectvendorSuccess
            });
        }

        function eachlnknavigation(nPos, src) {
            if (src.href != "") {
                jQuery(src).click(clicklnkselectvendorid);
            }
        }

        function clickbtnSubmitSearchVendorid(src, arg) {
            //debugger;

            //Display load image
            ShowLoadingDialog();

            //Get the search value
            var szSearchVendor = jQuery("#searchItemVendor").val();

            // Get the url
            var lnkResethref = jQuery("#lnkResetVendorId").attr("href");

            if (szSearchVendor != "") {
                var szUrl = lnkResethref + '?searchItemVendor=' + szSearchVendor;

                jQuery.ajax({
                    type: 'GET',
                    url: szUrl,
                    data: null,
                    //contentType: 'application/json; charset=utf-8',
                    dataType: 'html',
                    error: AjaxFailed,
                    success: selectvendorSuccess
                });
            }
        }

        function eachlnkSelectVendor(nPos, src) {
            jQuery(src).click(clicklnkSelectVendor);
        }

        function clicklnkSelectVendor(src, arg) {
            src.preventDefault();


            var szMsg01 = "";
            var szMsg02 = "";
            var szMsg03 = "";
            var szMsg = src.target.href;
            var szItemIdHlp = szMsg.split('/');
            var szItemId = szItemIdHlp[szItemIdHlp.length - 1];

            //Get and displat the selected values
            jQuery("#VendorId").val(szItemId);

            szMsg = '#fn_' + szItemId;
            szMsg01 = jQuery(szMsg).html();
            szMsg01 = jQuery.trim(szMsg01);
            szMsg = '#ln_' + szItemId;
            szMsg02 = jQuery(szMsg).html();
            szMsg02 = jQuery.trim(szMsg02);
            jQuery("#firstlastnameid").html(szMsg01 + ' ' + szMsg02);

            szMsg = '#cmp_' + szItemId;
            szMsg01 = jQuery(szMsg).html();
            szMsg01 = jQuery.trim(szMsg01);
            jQuery("#td_companynameid").html(szMsg01);

            szMsg = '#adr_' + szItemId;
            szMsg01 = jQuery(szMsg).html();
            szMsg01 = jQuery.trim(szMsg01);
            jQuery("#td_addressid").html(szMsg01);

            szMsg = '#cty_' + szItemId;
            szMsg01 = jQuery(szMsg).html();
            szMsg01 = jQuery.trim(szMsg01);

            //debugger;

            szMsg = '#sta_' + szItemId;
            szMsg02 = jQuery(szMsg).html();
            szMsg02 = jQuery.trim(szMsg02);
            if (szMsg02 != "") {
                szMsg02 = ', ' + szMsg02
            }

            szMsg = '#zp_' + szItemId;
            szMsg03 = jQuery(szMsg).html();
            szMsg03 = jQuery.trim(szMsg03);
            jQuery("#td_cityid").html(szMsg01 + szMsg02 + ' ' + szMsg03);

            jQuery("#selectvendorDialog").dialog("close");

        }

        function clicklnkselectlocationid(src, arg) {
            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get the partial view
            var szUrl = jQuery(src.target).attr("href");

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: selectlocationSuccess
            });
        }

        function selectlocationSuccess(response, statusCode) {
            var objRes = response;

            //Display the response data
            jQuery("#selectvendorDialog").html(objRes);

            //Hide load image
            HideLoadingDialog();

            //Set the buttons lnkResetId
            jQuery(".btn btn-default").button();

            //Attach handlers 
            jQuery("#btDialogClose").click(clickbtDialogClose);
            jQuery("#btnSubmitSearchLocationid").click(clickbtnSubmitSearchLocationid02);

            jQuery(".btnSubmitSearchLocation a").each(eachbtnSubmitSearchVendor);
            jQuery(".lnkSelectLocation a").each(eachlnkSelectLocation);

            //debugger;
            jQuery(".btnSubmitSearchLocationlnk a").click(clickbtnSubmitSearchLocationid01);

            jQuery(".pagination ul li a").each(eachlnknavigationlocation);
            //Initialize fields

            //Get the title 
            //debugger;
            var szTitle = "Location";

            //Show the dialog (used with the BuscarDepartamento call)
            jQuery("#selectvendorDialog").dialog("option", "title", "Select " + szTitle);

            //setter
            jQuery("#selectvendorDialog").dialog("option", "width", 700);

            //display the popup dialog
            jQuery("#selectvendorDialog").dialog("open");

        }

        function eachlnkSelectLocation(nPos, src) {
            //debugger;
            jQuery(src).click(clicklnkSelectLocation);
        }

        function clicklnkSelectLocation(src, arg) {
            src.preventDefault();

            //debugger;

            var szMsg01 = "";
            var szMsg02 = "";
            var szMsg03 = "";
            var szMsg = src.target.href;
            var szItemIdHlp = szMsg.split('/');
            var szItemId = szItemIdHlp[szItemIdHlp.length - 1];

            //Get and displat the selected values
            jQuery("#CustomerShiptoId").val(szItemId);

            szMsg = '#fn_' + szItemId;
            szMsg01 = jQuery(szMsg).html();
            szMsg01 = jQuery.trim(szMsg01);
            szMsg = '#ln_' + szItemId;
            szMsg02 = jQuery(szMsg).html();
            szMsg02 = jQuery.trim(szMsg02);
            jQuery("#STfirstlastnameid").html(szMsg01 + ' ' + szMsg02);

            szMsg = '#cmp_' + szItemId;
            szMsg01 = jQuery(szMsg).html();
            szMsg01 = jQuery.trim(szMsg01);
            jQuery("#td_STcompanynameid").html(szMsg01);

            szMsg = '#adr_' + szItemId;
            szMsg01 = jQuery(szMsg).html();
            szMsg01 = jQuery.trim(szMsg01);
            jQuery("#td_STaddressid").html(szMsg01);

            szMsg = '#cty_' + szItemId;
            szMsg01 = jQuery(szMsg).html();
            szMsg01 = jQuery.trim(szMsg01);

            //debugger;

            szMsg = '#sta_' + szItemId;
            szMsg02 = jQuery(szMsg).html();
            szMsg02 = jQuery.trim(szMsg02);
            if (szMsg02 != "") {
                szMsg02 = ', ' + szMsg02
            }

            szMsg = '#zp_' + szItemId;
            szMsg03 = jQuery(szMsg).html();
            szMsg03 = jQuery.trim(szMsg03);
            jQuery("#td_STcityid").html(szMsg01 + szMsg02 + ' ' + szMsg03);

            szMsg = '#prf_' + szItemId;
            szMsg01 = jQuery(szMsg).html();
            szMsg01 = jQuery.trim(szMsg01);
            jQuery("#ShipVia").val(szMsg01);


            jQuery("#selectvendorDialog").dialog("close");

        }

        function clickbtnSubmitSearchLocationid02(src, arg) {
            //debugger;

            var szSearchLocation = jQuery("#searchLocation").val();
            if (szSearchLocation != "") {

                //Display load image
                ShowLoadingDialog();


                //Get Customerid
                var szCustomerId = jQuery("#selectlocationcustmerid").html();
                szCustomerId = jQuery.trim(szCustomerId);

                //Get the partial view
                var szUrl = jQuery("#lnkResetLocationId").attr("href");
                szUrl = szUrl + '&searchLocation=' + szSearchLocation;


                jQuery.ajax({
                    type: 'GET',
                    url: szUrl,
                    data: null,
                    //contentType: 'application/json; charset=utf-8',
                    dataType: 'html',
                    error: AjaxFailed,
                    success: selectlocationSuccess
                });

            }
        }

        function clickbtnSubmitSearchLocationid01(src, arg) {
            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get Customerid
            var szCustomerId = jQuery("#selectlocationcustmerid").html();
            szCustomerId = jQuery.trim(szCustomerId);

            //Get the partial view
            var szUrl = jQuery(src.target.parentNode).attr("href");
            szUrl = szUrl + '&customerid=' + szCustomerId;

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: selectlocationSuccess
            });

        }

        function eachlnknavigationlocation(nPos, src) {
            if (src.href != "") {
                jQuery(src).click(clicklnknavigationlocation);
            }
        }

        function clicklnknavigationlocation(src, arg) {
            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get Customerid
            var szCustomerId = jQuery("#selectlocationcustmerid").html();
            szCustomerId = jQuery.trim(szCustomerId);

            //Get the partial view
            var szUrl = jQuery(src.target).attr("href");
            szUrl = szUrl + '&customerid=' + szCustomerId;

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: selectlocationSuccess
            });
        }

        function clickbtnSubmitSearchLocationid(src, arg) {
            //debugger;

            //Display load image
            ShowLoadingDialog();

            //Get the search value
            var szSearchVendor = jQuery("#searchLocation").val();

            // Get the url
            var lnkResethref = jQuery("#lnkResetLocationId").attr("href");

            if (szSearchVendor != "") {
                var szUrl = lnkResethref + '&searchLocation=' + szSearchVendor;

                jQuery.ajax({
                    type: 'GET',
                    url: szUrl,
                    data: null,
                    //contentType: 'application/json; charset=utf-8',
                    dataType: 'html',
                    error: AjaxFailed,
                    success: selectvendorSuccess
                });
            }
        }

        function clickgetsalesdetailsId(src, arg) {
            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get url
            var szUrl = jQuery(src.target).attr("href");

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: getdetailsSuccess
            });
        }

        function getdetailsSuccess(response, statusCode) {
            //debugger;
            var objRes = response;

            //Display the response data
            jQuery("#salesdetailsid").html(objRes);

            //Hide load image
            HideLoadingDialog();

            //Set readonly fields
            // the tax should be on product only, no tax on service
            jQuery(".service input").each(eachSOdetailservice)

            //Set the buttons lnkResetId
            jQuery(".btn btn-default").button();

            //Attach handlers 
            jQuery(".pagination ul li a").each(eachlnknavigationDetails);

            jQuery(".lnkEditDetail a").each(eachlnkEditDetail);
            jQuery(".lnkUpdateDetail a").each(eachlnkUpdateDetail);
            jQuery("#lnkAddSalesOrderDetail").click(clicklnkAddSalesOrderDetail);
            jQuery(".lnkAddDetail a").each(eachlnkAddDetail);
            jQuery(".lksalesdetailQty input").each(eachlksalesdetailQty);

        }
        function eachSOdetailservice(nPos, src) {
            //debugger;
            jQuery(src).attr("readonly", "readonly");
            jQuery(src).attr("disabled");
        }
        function eachlnknavigationDetails(nPos, src) {
            if (src.href != "") {
                jQuery(src).click(clicklnknavigationDetails);
            }
        }

        function clicklnknavigationDetails(src, arg) {
            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get the sales order id
            var szSalesOrderId = jQuery("#SalesOrderId").val();

            //Get the partial view
            var szUrl = jQuery(src.target).attr("href");
            szUrl = szUrl + '&salesorderid=' + szSalesOrderId;

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: getdetailsSuccess
            });
        }

        function clicklnkBlindShip(src, arg) {

            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();


            //Get the partial view
            var szUrl = jQuery(src.target).attr("href");

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: blindshipSuccess
            });
        }

        function blindshipSuccess(response, statusCode) {
            //debugger;
            var objRes = response;

            //Display the response data
            jQuery("#selectvendorDialog").html(objRes);

            //Hide load image
            HideLoadingDialog();

            //Set the buttons lnkResetId
            jQuery(".btn btn-default").button();

            //Attach handlers 
            jQuery("#btDialogClose").click(clickbtDialogClose);

            //Initialize fields

            //Get the title 
            //debugger;
            var szTitle = "Blind Ship Address";

            //Show the dialog (used with the BuscarDepartamento call)
            jQuery("#selectvendorDialog").dialog("option", "title", "Select " + szTitle);

            //setter
            jQuery("#selectvendorDialog").dialog("option", "width", 480);

            //display the popup dialog
            jQuery("#selectvendorDialog").dialog("open");
        }

        function clickIsBlindShip(src, arg) {
            //debugger;
            if (src.target.checked) {
                jQuery("#lnkBlindShip").trigger('click');
            }
        }

        function eachlnkEditDetail(nPos, src) {
            jQuery(src).click(clicklnkEditDetail);
        }

        function clicklnkEditDetail(src, arg) {

            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();


            //Get the partial view
            var szUrl = jQuery(src.target).attr("href");

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: editdetailSuccess
            });
        }

        function editdetailSuccess(response, status) {
            //debugger;

            var objRes = response;

            //Display the response data
            jQuery("#selectvendorDialog").html(objRes);

            //Hide load image
            HideLoadingDialog();

            //Set the buttons lnkResetId
            jQuery(".btn btn-default").button();

            //Attach handlers 
            jQuery("#btDialogClose").click(clickbtDialogClose);
            jQuery("#btnSubmitSearchLocationid").click(clickbtnSubmitSearchLocationid02);

            jQuery(".btnSubmitSearchLocation a").each(eachbtnSubmitSearchVendor);
            jQuery(".lnkSelectLocation a").each(eachlnkSelectLocation);

            jQuery(".btnSubmitSearchLocationlnk a").click(clickbtnSubmitSearchLocationid01);

            jQuery(".pagination ul li a").each(eachlnknavigationlocation);
            //Initialize fields

            //Get the title 
            //debugger;
            var szTitle = "Sales Order Detail";

            //Show the dialog (used with the BuscarDepartamento call)
            jQuery("#selectvendorDialog").dialog("option", "title", "Edit " + szTitle);

            //setter
            jQuery("#selectvendorDialog").dialog("option", "width", 800);

            //display the popup dialog
            jQuery("#selectvendorDialog").dialog("open");
        }

        function clicklnkAddSalesOrderDetail(src, arg) {
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //debugger;
            //Get the partial view
            var szUrl = jQuery(src.target).attr("href");

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: adddetailSuccess
            });
        }

        function adddetailSuccess(response, status) {
            //debugger;

            var objRes = response;

            //Display the response data
            jQuery("#selectvendorDialog").html(objRes);

            //Hide load image
            HideLoadingDialog();

            //Set the buttons 
            jQuery(".btn btn-default").button();
            jQuery(".btnSubmitSearch").button();

            //Attach handlers 
            jQuery("#btDialogClose").click(clickbtDialogClose);
            jQuery(".pagination ul li a").each(eachlnknavigationAddDetail);
            jQuery(".lnkResetId a").click(clicklnkResetId);
            jQuery("#searchsubitemid").submit(submitsearchsubitemid);


            //Initialize fields

            //Get the title 
            //debugger;
            var szTitle = "Sales Order Detail";

            //Show the dialog (used with the BuscarDepartamento call)
            jQuery("#selectvendorDialog").dialog("option", "title", "Add " + szTitle);

            //setter
            jQuery("#selectvendorDialog").dialog("option", "width", 800);

            //display the popup dialog
            jQuery("#selectvendorDialog").dialog("open");
        }

        function eachlnknavigationAddDetail(nPos, src) {
            if (src.href != "") {
                jQuery(src).click(clicklnknavigationAddDetail);
            }
        }

        function clicklnknavigationAddDetail(src, arg) {
            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get the partial view
            var szUrl = jQuery(src.target).attr("href");

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: adddetailSuccess
            });
        }

        function clicklnkResetId(src, arg) {
            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get the partial view
            var szUrl = jQuery(src.target.parentNode).attr("href");

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: adddetailSuccess
            });
        }

        function submitsearchsubitemid(src, arg) {
            //debugger;
            src.preventDefault();

            //Display load image
            ShowLoadingDialog();

            //Get the seacrh parameter
            var szSearchItem = jQuery("#searchItem").val();

            //Get the partial view
            var szUrl = jQuery(src.target).attr("action");
            if (szSearchItem != "") {
                szUrl = szUrl + '&searchitem=' + szSearchItem;
            }

            jQuery.ajax({
                type: 'GET',
                url: szUrl,
                data: null,
                //contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                error: AjaxFailed,
                success: adddetailSuccess
            });
        }

        function changesalesordercontactselectorId(src, arg) {
            //debugger;
            var nSelected = src.target.selectedIndex;
            var nId = src.target[nSelected].value;
            if (nId != "") {
                jQuery(".vendoridddl #VendorId").val(nId);
            }
        }

        function eachlnkUpdateDetail(nPos, src) {
            jQuery(src).click(clicklnkUpdateDetail);
        }

        function clicklnkUpdateDetail(src, arg) {
            //debugger;

            var hrefHlp = src.target.href;
            var szHlp = hrefHlp.split('/');
            var szMsg = "";
            var szQty = "";
            var szShipQty = "";
            var szBOQty = "";
            var szDesc = "";
            var szTax = "";
            var szPrice = "";
            var szId = "0";
            var nPos = -1;
            szMsg = szHlp[szHlp.length - 1];
            nPos = szMsg.indexOf('?');
            if (nPos != -1) {
                szId = szMsg.substring(0, nPos);
            }
            if (szId != "0") {
                szMsg = "#qty_" + szId + ' input';
                szQty = jQuery(szMsg).val();
                szMsg = "#shipqty_" + szId + ' input';
                szShipQty = jQuery(szMsg).val();
                szMsg = "#boqty_" + szId + ' input';
                szBOQty = jQuery(szMsg).val();
                szMsg = "#desc_" + szId + ' input';
                szDesc = jQuery(szMsg).val();
                szMsg = "#tax_" + szId + ' input';
                szTax = jQuery(szMsg).val();
                szMsg = "#price_" + szId + ' input';
                szPrice = jQuery(szMsg).val();

                hrefHlp = hrefHlp + '&qty=' + szQty + '&shipqty=' + szShipQty + '&boqty=' + szBOQty + '&desc=' + szDesc + '&price=' + szPrice + '&tax=' + szTax;
                src.target.href = hrefHlp;
            }
        }

        function eachlnkAddDetail(nPos, src) {
            //debugger;
            jQuery(src).click(clicklnkAddDetail);
        }
        function clicklnkAddDetail(src, arg) {
            //debugger;
            src.preventDefault();

            var nPos = -1;
            var nPos1 = -1;
            var itemPos = 0;
            var itemOrder = 0;
            var szMsg = "";
            var hRefHlp0 = src.target.href;
            var hRefHlp = hRefHlp0.split('=');
            if (hRefHlp != null) {
                itemOrder = hRefHlp[hRefHlp.length - 1];

                nPos = hRefHlp0.indexOf("itemPos=");
                if (nPos != -1) {
                    szMsg = hRefHlp0.substring(nPos + 8);
                    nPos1 = szMsg.indexOf("&");
                    if (nPos1 != -1) {
                        itemPos = szMsg.substring(0, nPos1);
                    }
                }
            }

            var hrefAdd = jQuery("#lnkAddSalesOrderDetail").attr("href");
            if (itemPos != "") {
                hrefAdd = hrefAdd + '&itemPos=' + itemPos + '&itemOrder=' + itemOrder;
                jQuery("#lnkAddSalesOrderDetail").attr("href", hrefAdd)
            }

            jQuery("#lnkAddSalesOrderDetail").trigger('click');
        }

        function eachlksalesdetailQty(nPos, src) {
            jQuery(src).change(changesalesdetailQty);
        }
        function changesalesdetailQty(src, arg) {
            //debugger;
            var szMsg = src.target.parentNode.id;
            szMsg = szMsg.replace("qty_", "lkup_");
            var lkHlp = jQuery("#" + szMsg).attr("href");

            var hrefHlp = lkHlp;
            var szHlp = hrefHlp.split('/');
            var szMsg = "";
            var szQty = "";
            var szShipQty = "";
            var szBOQty = "";
            var szDesc = "";
            var szPrice = "";
            var szTax = "";
            var szId = "0";
            var nPos = -1;
            szMsg = szHlp[szHlp.length - 1];
            nPos = szMsg.indexOf('?');
            if (nPos != -1) {
                szId = szMsg.substring(0, nPos);
            }
            if (szId != "0") {
                szMsg = "#qty_" + szId + ' input';
                szQty = jQuery(szMsg).val();
                szMsg = "#shipqty_" + szId + ' input';
                szShipQty = jQuery(szMsg).val();
                szMsg = "#boqty_" + szId + ' input';
                szBOQty = jQuery(szMsg).val();
                szMsg = "#desc_" + szId + ' input';
                szDesc = jQuery(szMsg).val();
                szMsg = "#tax_" + szId + ' input';
                szTax = jQuery(szMsg).val();
                szMsg = "#price_" + szId + ' input';
                szPrice = jQuery(szMsg).val();

                hrefHlp = hrefHlp + '&qty=' + szQty + '&shipqty=' + szShipQty + '&boqty=' + szBOQty + '&desc=' + szDesc + '&price=' + szPrice + '&tax=' + szTax;
                //src.target.href = hrefHlp;
                //Display load image
                ShowLoadingDialog();

                window.location(hrefHlp);
            }
        }

        function submiteditsalesorderid(src, arg) {
            //debugger;
            //var szYear = "";
            //var szMonth = "";
            //var szDay = "";
            //var szDateHlp = jQuery("#SODate").val();
            //var szMsg = szDateHlp.split('/');
            //if (szMsg != "") {
            //    szMonth = szMsg[0];
            //    szMonth = jQuery.trim(szMonth);
            //    szDay = szMsg[1];
            //    szYear = szMsg[2];
            //    //szDateHlp = szDay + '/' + szMonth + '/' + szYear;
            //    szDateHlp = szYear + '/' + szMonth + '/' + szDay;
            //    jQuery("#SODate").val(szDateHlp);
            //}
        }
    </script>
}


@using (Html.BeginForm("Edit", "SalesOrder", FormMethod.Post, new { id = "editsalesorderid" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)
    @Html.HiddenFor(model => model.SalesOrderId)
    @Html.HiddenFor(model => model.CustomerId)
    @Html.HiddenFor(model => model.SalesOrderNo)
    @Html.HiddenFor(model => model.PaymentAmount)
    @Html.HiddenFor(model => model.PaymentDate)
    @*Html.HiddenFor(model => model.Tax_rate)*@
    @Html.HiddenFor(model => model.Invs_Tax)

    TimelyDepotMVC.DAL.TimelyDepotContext db01 = new TimelyDepotMVC.DAL.TimelyDepotContext();
    string szAsi = "";
    string szSAGE = "";
    string szWebSite = "";
    string szEmail = "";

    string szAddress = "";
    string szAddressHlp = "";
    string szAddressHlp1 = "";
    string szAddressHlp2 = "";
    string szAddressHlp3 = "";
    string szCompany = "";
    string szAddressHlp4 = "";
    string szAddressHlp5 = "";
    string szAddressHlp6 = "";
    string szCompany2 = "";
    string szCity = "";
    string szState = "";
    string szZip = "";
    string szCountry = "";
    string szCountry2 = "";
    string szTel2 = "";
    string szTel = "";
    string szFax = "";
    string szWebSiteTrade = "";
    string szEmailTrade = "";
    string szFirstName = "";
    string szLastName = "";
    string szFirstName2 = "";
    string szLastName2 = "";
    string szTradeName = "";
    string szAsiTrade = "";
    string szSageTrade = "";
    string szPpaiTrade = "";
    string szMsg = "";
    string szMsg01 = "";
    string szShipDate = "";
    string szSODate = "";
    DateTime dShipDate = DateTime.Now;
    DateTime dSODate = DateTime.Now;

    if (Model.SODate == null)
    {
        dSODate = DateTime.Now;
        szSODate = dShipDate.ToString("MM/dd/yyyy"); ;
    }
    else
    {
        dSODate = Convert.ToDateTime(Model.SODate);
        szSODate = dSODate.ToString("MM/dd/yyyy");
    }


    if (Model.ShipDate == null)
    {
        dShipDate = DateTime.Now;
        szShipDate = dShipDate.ToString("MM/dd/yyyy"); ;
    }
    else
    {
        dShipDate = Convert.ToDateTime(Model.ShipDate);
        szShipDate = dShipDate.ToString("MM/dd/yyyy");
    }


    long telHlp = 0;
    long faxHlp = 0;
    string telfmt = "000-000-0000";

    TimelyDepotMVC.Controllers.SalesOrderController.GetCustomerData(db01, ref szAsi, ref szSAGE, ref szWebSite, ref szEmail, Convert.ToInt32(Model.CustomerId));
    TimelyDepotMVC.Controllers.SalesOrderController.GetTradeData(db01, ref szAddress, ref szCity, ref szState, ref szZip, ref szCountry, ref szTel, ref szFax,
        ref szWebSiteTrade, ref szEmailTrade, ref szTradeName, ref szAsiTrade, ref szSageTrade, ref szPpaiTrade, Convert.ToInt32(Model.TradeId));
    if (string.IsNullOrEmpty(szTel))
    {
        szTel = "0";
    }
    telHlp = Convert.ToInt64(szTel);
    szTel = telHlp.ToString(telfmt);
    if (string.IsNullOrEmpty(szFax))
    {
        szFax = "0";
    }
    telHlp = Convert.ToInt64(szFax);
    szFax = telHlp.ToString(telfmt);


    TimelyDepotMVC.Models.Admin.CustomersContactAddress soldto = null;
    if (ViewBag.SoldTo != null)
    {
        soldto = ViewBag.SoldTo;
    }
    else
    {
        soldto = new TimelyDepotMVC.Models.Admin.CustomersContactAddress();
    }

    TimelyDepotMVC.Models.Admin.VendorsContactAddress venaddress = null;
    if (ViewBag.VendorAddress != null)
    {
        venaddress = ViewBag.VendorAddress;
    }
    else
    {
        venaddress = new TimelyDepotMVC.Models.Admin.VendorsContactAddress();
    }

    if (!string.IsNullOrEmpty(venaddress.State))
    {
        venaddress.State = string.Format(", {0}", venaddress.State);
    }
    szAddressHlp = string.Format("{0}{1} {2}", venaddress.City, venaddress.State, venaddress.Zip);

    TimelyDepotMVC.Models.Admin.CustomersBillingDept billto = null;
    if (ViewBag.BillTo != null)
    {
        billto = ViewBag.BillTo;
    }
    else
    {
        billto = new TimelyDepotMVC.Models.Admin.CustomersBillingDept();
    }

    TimelyDepotMVC.Models.Admin.CustomersShipAddress shipto = null;
    if (ViewBag.ShipTo != null)
    {
        shipto = ViewBag.ShipTo;
    }
    else
    {
        shipto = new TimelyDepotMVC.Models.Admin.CustomersShipAddress();
    }

    if (!string.IsNullOrEmpty(shipto.State))
    {
        shipto.State = string.Format(", {0}", shipto.State);
    }
    szAddressHlp1 = string.Format("{0}{1} {2}", shipto.City, shipto.State, shipto.Zip);

    TimelyDepotMVC.Models.Admin.VendorsSalesContact vendorsalescontact = null;
    if (ViewBag.VendorSalesContact != null)
    {
        vendorsalescontact = ViewBag.VendorSalesContact;
    }
    else
    {
        vendorsalescontact = new TimelyDepotMVC.Models.Admin.VendorsSalesContact();
    }

    TimelyDepotMVC.Models.Admin.SalesOrderBlindShip salesorderblindship = null;
    if (ViewBag.BlindShip != null)
    {
        salesorderblindship = ViewBag.BlindShip;
    }
    else
    {
        salesorderblindship = new TimelyDepotMVC.Models.Admin.SalesOrderBlindShip();
    }

    //Select Blind ship or Trade name
    if (Model.IsBlindShip)
    {
        //szFirstName = salesorderblindship.FirstName;
        //szLastName = salesorderblindship.LastName;
        //szAddressHlp2 = string.Format("{0} {1}", salesorderblindship.Address1, salesorderblindship.Address2);
        //szAddressHlp3 = string.Format("{0}{1} {2}", salesorderblindship.City, salesorderblindship.State, salesorderblindship.Zip);

        szFirstName = soldto.FirstName;
        szLastName = soldto.LastName;
        szCompany = soldto.CompanyName;
        szAddressHlp2 = string.Format("{0}", soldto.Address);
        szAddressHlp3 = string.Format("{0} {1} {2}", soldto.City, soldto.State, soldto.Zip);


        szFirstName2 = salesorderblindship.FirstName;
        szLastName2 = salesorderblindship.LastName;
        szCompany2 = salesorderblindship.Title;
        szAddressHlp4 = string.Format("{0}", salesorderblindship.Address1, salesorderblindship.Address2);
        szAddressHlp6 = string.Format("{0}", salesorderblindship.Address2);
        szAddressHlp5 = string.Format("{0} {1} {2}", salesorderblindship.City, salesorderblindship.State, salesorderblindship.Zip);
        szCountry2 = salesorderblindship.Country;
        telHlp = Convert.ToInt64(salesorderblindship.Tel);
        szTel2 = telHlp.ToString(telfmt);
    }
    else
    {
        szFirstName = szTradeName;
        szAddressHlp2 = szAddress;
        szAddressHlp3 = string.Format("{0} {1} {2}", szCity, szState, szZip);

        szFirstName2 = shipto.FirstName;
        szLastName2 = shipto.LastName;
        szCompany2 = soldto.CompanyName;
        szAddressHlp4 = string.Format("{0}", shipto.Address1);
        szAddressHlp5 = string.Format("{0} {1} {2}", shipto.City, shipto.State, shipto.Zip);

    }
    <div class="error" style="margin: 5px;">@ViewBag.ErrorSalesOrder</div>
    <div style="margin: 10px;">
        <table border="0" cellpadding="0" cellspacing="0" style="width: 100%; border: 0px solid #CC00CC;">
            <tr>
                <td>
                    <div>
                        <div class="right" style="padding-top: 5px; padding-right: 5px;">
                            <div class="editor-label left" style="padding-right: 5px;">
                                @Html.LabelFor(model => model.SalesOrderNo):
                            </div>
                            <div class="editor-field">
                                @Html.DisplayFor(model => model.SalesOrderNo)
                                @*                                @Html.EditorFor(model => model.SalesOrderNo)
                                @Html.ValidationMessageFor(model => model.SalesOrderNo)*@
                            </div>
                        </div>
                        <div>
                            <div class="divh1" style="text-align: center">@ViewBag.Title
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div>
                        <div class="right" style="padding-right: 5px;">
                            <div>
                                <div class="editor-label left" style="padding-right: 5px;">
                                    @*@Html.LabelFor(model => model.CustomerId)*@
                                    Customer No :
                                </div>
                                <div class="editor-field">
                                    @if (ViewBag.Customer != null)
                                    {
                                        if (ViewBag.Customer.CustomerNo != null)
                                        {
                                        @ViewBag.Customer.CustomerNo                                       
                                        }

                                    }
@*                                    @Html.DisplayFor(model => model.CustomerId)
                                    @Html.ValidationMessageFor(model => model.CustomerId)*@
                                </div>
                            </div>
                        </div>
                        <div>&nbsp;</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div>
                        <div class="right" style="padding-right: 5px;">
                            ASI:&nbsp;@szAsiTrade&nbsp;SAGE:&nbsp;@szSageTrade
                        </div>
                        <div>
                            @Html.DropDownList("TradeId", (IEnumerable<SelectListItem>)ViewBag.TradeList, "Select Trade", new { id = "tradeselectorId" })
                            <div style="display: none;">
                                @*<input id="tradeIdX" name="tradeIdX" type="text" />*@
                                @Html.EditorFor(model => model.TradeId)
                                @Html.ValidationMessageFor(model => model.TradeId)
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div>
                        <div class="right" style="padding-right: 5px;">
                            @szWebSiteTrade
                        </div>
                        <div>@szEmailTrade</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div>
                        <div class="right" style="padding-right: 5px;">
                            @szEmail
                        </div>
                        <div>@szCity,&nbsp;@szState&nbsp;@szZip</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div>
                        <div class="right" style="padding-right: 5px;">
                            &nbsp;
                        </div>
                        <div>Tel:&nbsp;@szTel</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div style="padding-right: 30px;">
                        <div class="right" style="padding-right: 5px;">
                            <div class="editor-label left">
                                Blind Ship
                                @*@Html.LabelFor(model => model.IsBlindShip)*@
                            </div>
                            <div class="editor-field">
                                @Html.EditorFor(model => model.IsBlindShip)
                                @Html.ValidationMessageFor(model => model.IsBlindShip)
                            </div>
                        </div>
                        <div>Fax:&nbsp;@szFax</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div style="margin: 5px 30px 5px 30px;">
                        <div class="right" style="width: 48%; border: 0px solid #009933;">

                            <table border="0" cellpadding="0" cellspacing="0" style="width: 100%; border: 0px solid #0066FF;">
                                <tr>
                                    <td><span style="font-size: 1.1em; font-weight: bold; margin-right: 5px;">Ship from:</span><span style="display: none;">@Html.ActionLink("Select Vendor", "SelectVendor", "SalesOrder", null, new { id = "lnkselectvendorid" })</span></td>
                                </tr>
                                <tr>
                                    <td class="tdA tdLineTop tdLineLR">
                                        <div class="left" style="margin-right: 23px;">&nbsp;</div>
                                        <div id="firstlastnameid">@szFirstName&nbsp;@szLastName</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td id="td_companynameid" class="tdB tdLineLR">@szCompany</td>
                                </tr>
                                <tr>
                                    <td id="td_addressid" class="tdB tdLineLR">@szAddressHlp2</td>
                                </tr>
                                <tr>
                                    <td id="td_cityid" class="tdB tdLineLR">@szAddressHlp3</td>
                                </tr>
                                <tr>
                                    <td class="tdA tdLineBottom tdLineLR">@*<span style="display: none;">@Html.EditorFor(model => model.VendorId)</span>*@</td>
                                </tr>
                            </table>
                        </div>
                        <div style="padding-right: 10px; border: 0px solid #FF9900;">
                            <table border="0" cellpadding="0" cellspacing="0" style="width: 50%; border: 0px solid #0066FF;">
                                <tr>
                                    <td><span style="font-size: 1.1em; font-weight: bold;">Sold to:</span></td>
                                </tr>
                                <tr>
                                    <td class="tdA tdLineTop tdLineLR">Attn:&nbsp;@soldto.CompanyName</td>
                                </tr>
                                <tr>
                                    <td class="tdB tdLineLR">@soldto.Address</td>
                                </tr>
                                @*                                <tr>
                                    <td class="tdB tdLineLR">P.O. BOX&nbsp;@soldto.Zip</td>
                                </tr>*@
                                <tr>
                                    <td class="tdB tdLineLR">@soldto.City,&nbsp;@soldto.State&nbsp;@soldto.Zip</td>
                                </tr>
                                @{
                                    telHlp = Convert.ToInt64(soldto.Tel);
                                    szMsg = telHlp.ToString(telfmt);
                                    telHlp = Convert.ToInt64(soldto.Fax);
                                    szMsg01 = telHlp.ToString(telfmt);
                                }
                                <tr>
                                    <td class="tdA tdLineBottom tdLineLR">Tel:&nbsp;@szMsg&nbsp;&nbsp;&nbsp;&nbsp;Fax:&nbsp;@szMsg01</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div style="margin: 5px 30px 5px 30px;">
                        <div class="right" style="width: 48%; border: 0px solid #009933;">

                            <table border="0" cellpadding="0" cellspacing="0" style="width: 100%; border: 0px solid #0066FF;">
                                <tr>
                                    <td><span style="font-size: 1.1em; font-weight: bold; margin-right: 5px;">Ship to:</span>
                                        @if (Model.IsBlindShip)
                                        {
                                            @Html.ActionLink("Edit Address", "BlindShip", "SalesOrder", new { salesorderid = @Model.SalesOrderId }, new { id = "lnkEditBlindShip" })  
                                        }
                                        else
                                        {
                                            @Html.ActionLink("Select Location", "SelectLocation", "SalesOrder", new { customerid = soldto.CustomerId }, new { id = "lnkselectlocationid" })                                                
                                        }

                                    </td>
                                </tr>
                                @if (Model.IsBlindShip)
                                {
                                    <tr>
                                        <td id="td_STcompanynameid" class="tdB tdLineTop  tdLineLR">@szCompany2</td>
                                    </tr>
                                    <tr>
                                        <td id="td_STaddressid" class="tdB tdLineLR">@szAddressHlp4</td>
                                    </tr>
                                    <tr>
                                        <td class="tdB tdLineLR">@szAddressHlp6</td>
                                    </tr>
                                    <tr>
                                        <td id="td_STcityid" class="tdB tdLineLR">@szAddressHlp5</td>
                                    </tr>
                                    <tr>
                                        <td class="tdB tdLineLR">@szCountry2</td>
                                    </tr>
                                    <tr>
                                        <td class="tdB tdLineLR">
                                            <div>
                                                <div class="left" style="margin-right: 5px;">Attn:</div>
                                                <div id="STfirstlastnameid">@szFirstName2</div>
                                            </div>
                                        </td>
                                    </tr>@*
                                    <tr>
                                        <td class="tdA LineLR">
                                            <div class="left" style="margin-right: 5px;">Attn:</div>
                                            <div id="STfirstlastnameid">@szFirstName2</div>
                                        </td>
                                    </tr>*@
                                    <tr>
                                        <td class="tdB tdLineLR">@szTel2</td>
                                    </tr>
                                    <tr>
                                        <td class="tdA tdLineBottom tdLineLR"><span style="display: none;">@Html.EditorFor(model => model.CustomerShiptoId)</span></td>
                                    </tr>

                                }
                                else
                                {                                        
                                    <tr>
                                        <td class="tdA tdLineTop tdLineLR">
                                            <div class="left" style="margin-right: 5px;">Attn:</div>
                                            <div id="STfirstlastnameid">@szFirstName2&nbsp;@szLastName2</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td id="td_STcompanynameid" class="tdB tdLineLR">@szCompany2</td>
                                    </tr>
                                    <tr>
                                        <td id="td_STaddressid" class="tdB tdLineLR">@szAddressHlp4</td>
                                    </tr>
                                    <tr>
                                        <td id="td_STcityid" class="tdB tdLineLR">@szAddressHlp5</td>
                                    </tr>
                                    <tr>
                                        <td class="tdA tdLineBottom tdLineLR"><span style="display: none;">@Html.EditorFor(model => model.CustomerShiptoId)</span></td>
                                    </tr>
                                }

                            </table>
                        </div>
                        <div style="padding-right: 10px; border: 0px solid #FF9900;">
                            <table border="0" cellpadding="0" cellspacing="0" style="width: 50%; border: 0px solid #0066FF;">
                                <tr>
                                    <td><span style="font-size: 1.1em; font-weight: bold;">Bill to:</span></td>
                                </tr>
                                <tr>
                                    <td class="tdA tdLineTop tdLineLR">Attn:&nbsp;@billto.FirstName&nbsp;@billto.LastName</td>
                                </tr>
                                <tr>
                                    <td class="tdB tdLineLR">@soldto.CompanyName</td>
                                </tr>
                                <tr>
                                    <td class="tdB tdLineLR">@billto.Address1</td>
                                </tr>
                                <tr>
                                    <td class="tdB tdLineLR">@billto.City,&nbsp;@billto.State&nbsp;@billto.Zip</td>
                                </tr>
                                @{
                                telHlp = Convert.ToInt64(billto.Tel);
                                szMsg = telHlp.ToString(telfmt);
                                telHlp = Convert.ToInt64(billto.Fax);
                                szMsg01 = telHlp.ToString(telfmt);
                                }
                                <tr>
                                    <td class="tdA tdLineBottom tdLineLR">Tel:&nbsp;@szMsg&nbsp;&nbsp;&nbsp;&nbsp;Fax:&nbsp;@szMsg01</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <table border="0" cellpadding="0" cellspacing="0" style="width: 100%; border: 0px solid #CC00CC;">
                        <tr>
                            <td class="tdTitle">S/O Date</td>
                            <td class="tdTitle">P/O No.</td>
                            <td class="tdTitle">Order Contact</td>
                            <td class="tdTitle">Ship Date</td>
                        </tr>
                        @{
                                DateTime dDate = Convert.ToDateTime(Model.SODate);
                        }
                        <tr>
                            <td class="tdTitle">
                                <div class="editor-field">
                                    <input id="SODateHlp" name="SODateHlp" type="text" value="@szSODate" />
                                    <div>
                                        @*                                        @Html.EditorFor(model => model.SODate)
                                        @Html.ValidationMessageFor(model => model.SODate)*@
                                    </div>
                                </div>
                            </td>
                            <td class="tdTitle">
                                <div class="editor-field">
                                    @Html.EditorFor(model => model.PurchaseOrderNo)
                                    @Html.ValidationMessageFor(model => model.PurchaseOrderNo)
                                </div>
                            </td>
                            <td class="tdTitle">
                                @if (ViewBag.SalesContactList != null)
                                {
                                    @Html.DropDownList("VendorId", (IEnumerable<SelectListItem>)ViewBag.SalesContactList, "Select Sales Contact", new { id = "salesordercontactselectorId" }) 
                                }
                                <div style="display: none;">
                                    <div class="vendoridddl">@Html.EditorFor(model => model.VendorId)</div>
                                    @Html.ValidationMessageFor(model => model.VendorId)

                                </div>
                            </td>
                            <td class="tdTitle">
                                <div class="editor-field">
                                    <input id="ShipDateHlp" name="ShipDateHlp" type="text" value="@szShipDate" />
                                    @*                                    @Html.EditorFor(model => model.ShipDate)
                                    @Html.ValidationMessageFor(model => model.ShipDate)*@
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td class="tdTitle">Ship Via</td>
                            <td class="tdTitle">Terms</td>
                            <td class="tdTitle">Sales Rep.</td>
                            <td class="tdTitle">Warehouse</td>
                        </tr>
                        <tr>
                            <td class="tdTitle">
                                <div class="editor-field">
                                    @Html.EditorFor(model => model.ShipVia)
                                    @Html.ValidationMessageFor(model => model.ShipVia)
                                </div>
                            </td>
                            <td class="tdTitle">
                                <div class="editor-field">
                                    @Html.EditorFor(model => model.PaymentTerms)
                                    @Html.ValidationMessageFor(model => model.PaymentTerms)
                                </div>
                            </td>
                            <td class="tdTitle">
                                @*@ViewBag.Customer.SalesPerson*@
                                <div class="editor-field">
                                    @Html.EditorFor(model => model.SalesRep)
                                    @Html.ValidationMessageFor(model => model.SalesRep)
                                </div>

                            </td>
                            <td class="tdTitle">
                                @Html.DropDownList("VendorAddress", (IEnumerable<SelectListItem>)ViewBag.WarehouseList, "Select Warehouse", new { id = "vendoraddressselectorId" })
                                <div class="editor-field" style="display: none;">
                                    @Html.EditorFor(model => model.VendorAddress)
                                    @Html.ValidationMessageFor(model => model.VendorAddress)
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td>
                    <div id="salesdetailsid">
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div style="margin: 10px 30px 5px 30px;">
                        <table style="margin: 5px auto; width: 90%; border: 1px solid #D6E8FF;">
                            <tr>
                                <td style="vertical-align: top; padding-left: 5px;">Notes:</td>
                                <td style="width: 275px;">
                                    <div>
                                        <div class="right tdsalestotal">@ViewBag.SalesAmount</div>
                                        <div><span style="font-size: 1.0em; font-weight: bold;">Sales Amount:</span></div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td rowspan="6" style="vertical-align: top; padding-left: 5px;">
                                    <textarea id="Note" name="Note" cols="80" rows="8">@Model.Note</textarea>
                                </td>
                                <td>
                                    <div>
                                        <div class="right tdsalestotal">&nbsp;</div>
                                        <div>&nbsp;</div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div>
                                        <div class="right tdsalestotal">@ViewBag.TotalTax</div>
                                        @*<div>Tax&nbsp;@ViewBag.Tax&nbsp;%</div>*@
                                        <div>
                                            <div class="left" style="padding-top:5px;">Tax&nbsp;</div>
                                            <div class="viosinput40">
                                                @Html.EditorFor(model => model.Tax_rate)&nbsp;%
                                                @Html.ValidationMessageFor(model => model.Tax_rate)
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div>
                                        <div class="right viosinput80">@Html.EditorFor(model => model.ShippingHandling)</div>
                                        <div>Shipping & Handling</div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div>
                                        <div class="right tdsalestotal">@ViewBag.TotalAmount</div>
                                        <div>Total Amount:</div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div>
                                        <div class="right tdsalestotal">@Html.DisplayFor(model => model.PaymentAmount)</div>
                                        <div>Payment by VISA on @Html.DisplayFor(model => model.PaymentDate)</div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div>
                                        <div class="right tdsalestotal">@ViewBag.BalanceDue</div>
                                        <div><span style="font-size: 1.0em; font-weight: bold;">Balance Due:</span></div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </td>
            </tr>
            <tr>
                <td style="text-align: center;">
                    <input class="btnEditSO" type="submit" value="Save" />&nbsp;@Html.ActionLink("Back to List", "Index", null, new { @class = "btnEditSO" })&nbsp;@Html.ActionLink("Print (Pdf)", "SalesOrderReport", "iTextReports", new { SalesOrderId = Model.SalesOrderId }, new { @class = "btnEditSO", target = "_blank" })
                </td>
            </tr>
        </table>
        <div style="display: none;">@Html.ActionLink("Get Sales Details", "GetSalesDetails", "SalesOrder", new { salesorderid = Model.SalesOrderId }, new { id = "getsalesdetailsId" })</div>
    </div>
                
@*
    <fieldset>
        <legend>SalesOrder</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.CreaditCardNo)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.CreaditCardNo)
            @Html.ValidationMessageFor(model => model.CreaditCardNo)
        </div>

    </fieldset>*@
}

<div>
</div>
<div id="selectvendorDialog">
    Select vendor here
</div>
<div style="display: none;">
    @Html.ActionLink("Blind Ship", "BlindShip", "SalesOrder", new { salesorderid = @Model.SalesOrderId }, new { id = "lnkBlindShip" })
</div>
